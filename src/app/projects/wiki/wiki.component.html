<div class="col-12 full-v main-container" [ngClass]="{'preload': !isLoaded}">
    <div>
      <form>
        <div class="x_panel mh-auto">
          <div class="x_header">
            <div class="x_header_title">
              <h2>{{projectDetail.ProjectName}}
                <small>Project detail to update.</small>
                <i class="fa text-dark edit-icon ps-2"></i>
              </h2>
            </div>
          </div>
          <div class="px-1">
            <app-breadcrums></app-breadcrums>
          </div>
          <div [ngSwitch]="isLoaded">
            <div *ngSwitchCase="false">
              <div class="mt-5">
                <app-pre-load-table></app-pre-load-table>
              </div>
            </div>
            <div *ngSwitchDefault>
                <ng-container *ngIf="projectDetail.Title != null && projectDetail.Title != ''">
                    <div class="row col-12 mt-3 x_content full-height">
                        <div class="col-sm-3 col-md-2 x_panel" >
                            <div class="x_header">
                                <div class="x_header_title d-flex flex-row justify-content-between">
                                    <h6>{{projectDetail.ProjectName}}</h6>
                                </div>
                            </div>
                            <div id="side-menu-item">
                                <ul class="list-unstyled">
                                    <li >
                                        <a href="javascript:void(0)" class=" py-1 text-decoration-none text-dark d-flex align-items-center justify-content-between">
                                            <span>{{projectDetail.Title}}</span>
                                        </a>
                                        <ul class="list-unstyled ms-3" *ngIf="projectDetail.ProjectContent.length > 0">
                                            <li *ngFor="let item of projectDetail.ProjectContent">
                                                <a href="javascript:void(0)" class=" py-1 text-decoration-none text-dark d-flex align-items-center justify-content-between">
                                                    <span>{{item.SectionName}}</span>
                                                </a>
                                            </li>
                                        </ul>
                                    </li>
                                </ul>
                            </div>
                        </div>
                        <div class="col-md-10 col-sm-9 outline-none" id="main-container" (contextmenu)="manipulateSection($event)" (click)="closePopOver()" (keydown.esc)="closePopOver()" tabindex="0">
                          <div class="col-md-12 px-4 dv-space">
                            <h2>{{projectDetail.Title}}</h2>

                            <ng-container *ngIf="isLoaded">
                              <form [formGroup]="wikiForm">
                                <div formArrayName="Wikis">
                                  <div class="d-flex justify-content-around icon-section rounded" (contextmenu)="alert('hello')">
                                    <a href="javascript:void(0)" data-bs-toggle="tooltip" data-bs-placement="top" title="Add Section" class="fs-6 px-2 text-muted" (click)="addSubTitlePopUp()">
                                      <i class="fa fa-plus"></i>
                                    </a>
                                    <a href="javascript:void(0)" [ngClass]="{'pe-none': !isSectionEdited, 'blur-icon': !isSectionEdited}" data-bs-toggle="tooltip" data-bs-placement="top" title="Add image" class="fs-6 px-2 text-muted" (click)="addLinkPopUp()">
                                        <i class="fa fa-picture-o"></i>
                                    </a>
                                    <a href="javascript:void(0)" [ngClass]="{'pe-none': !isSectionEdited, 'blur-icon': !isSectionEdited}" data-bs-toggle="tooltip" data-bs-placement="top" title="Add paragraph" class="fs-6 px-2 text-muted" (click)="addParagraph()">
                                        <i class="fa fa-file-text"></i>
                                    </a>
                                    <a href="javascript:void(0)" [ngClass]="{'pe-none': !isSectionEdited, 'blur-icon': !isSectionEdited}" data-bs-toggle="tooltip" data-bs-placement="top" title="Add link" class="fs-6 px-2 text-muted" (click)="addLinkPopUp()">
                                        <i class="fa fa-anchor"></i>
                                    </a>
                                    <a href="javascript:void(0)" [ngClass]="{'pe-none': !isSectionEdited, 'blur-icon': !isSectionEdited}" data-bs-toggle="tooltip" data-bs-placement="top" title="Add list" class="fs-6 px-2 text-muted" (click)="enableListItem()">
                                        <i class="fa fa-link"></i>
                                    </a>
                                    <a href="javascript:void(0)" [ngClass]="{'pe-none': !isSectionEdited, 'blur-icon': !isSectionEdited}" data-bs-toggle="tooltip" data-bs-placement="top" title="Add chart" class="fs-6 px-2 text-muted">
                                        <i class="fa fa-line-chart"></i>
                                    </a>
                                    <a href="javascript:void(0)" [ngClass]="{'pe-none': !isSectionEdited, 'blur-icon': !isSectionEdited}" data-bs-toggle="tooltip" data-bs-placement="top" title="Edit" class="fs-6 px-2 text-muted" *ngIf="isSectionEdited" (click)="editCurrentSection()">
                                        <i class="fa fa-pencil"></i>
                                    </a>
                                    <a href="javascript:void(0)" class="fs-6 px-2 text-muted" *ngIf="!isSectionEdited" (click)="saveProjectDetails()">
                                      <i class="fa fa-paper-plane" data-bs-toggle="tooltip" data-bs-placement="top" title="Save"></i>
                                    </a>
                                  </div>

                                  <div *ngFor="let item of wikiForm.controls.Wikis['controls']; let i = index;"  [formGroupName]="i" id="section_{{i}}">
                                    <ng-container *ngIf="projectDetail.ProjectContent.length > 0">
                                      <div class="col-md-12 mx-3">
                                        <h5>
                                          <div class="d-flex flex-row justify-content-between">
                                              <div contenteditable="true" (keyup)="addSubSection($event)">
                                                {{item.get("WikiSection").value}}
                                              </div>
                                          </div>
                                        </h5>
                                        <div class="mt-3 content-dv overflow-none py-2 px-3"
                                        (dblclick)="enableCurrentSection($event)"
                                        name="content-container"
                                        [ngClass]="{'enable-section': i == sectionIndex}"
                                        [attr.contenteditable]="i == sectionIndex"
                                        (keypress.ctrl)="trackElement($event)"
                                        [innerHTML]='item.get("WikiSectionDetail").value'></div>
                                      </div>
                                    </ng-container>
                                  </div>
                                </div>
                              </form>
                            </ng-container>
                          </div>
                        </div>
                    </div>
                </ng-container>
                <ng-container *ngIf="projectDetail.Title == null || projectDetail.Title == ''">
                  <div class="my-5 py-5 text-center">
                    <h3 class="mt-5 pt-5">Please add project name and project title</h3>
                    <button class="btn btn-primary-c my-4" (click)="addTitlePopUp()"><i class="fa fa-plus pe-2"></i> Add Project Title</button>
                  </div>
                </ng-container>
            </div>
          </div>
        </div>
      </form>
    </div>
</div>

<!-- Add Title Modal -->
<div class="modal fade" id="addTitleModal" tabindex="-1" aria-labelledby="addTitleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content px-4">
      <div class="modal-header border-bottom-0">
        <h5 class="modal-title" id="addTitleModalLabel">Add Project Name and Project Title of the Project</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div>
          <label for="" class="form-label">Add Project Name</label>
          <input placeholder="Enter the Project name" type="text" class="form-control" [(ngModel)]="projectDetail.ProjectName"/>
        </div>
        <div>
          <label for="" class="form-label">Add Title</label>
          <textarea placeholder="Enter the title of this project" rows="3" type="text" class="form-control" [(ngModel)]="titleValue"></textarea>
        </div>
      </div>
      <div class="modal-footer border-top-0">
        <a href="javascript:void(0)" class="text-decoration-none text-danger" data-bs-dismiss="modal"><i class="fa fa-close pe-2"></i> Close</a>
        <a href="javascript:void(0)" class="text-decoration-none ms-3" (click)="addTitle()"><i class="fa fa-plus pe-2"></i>Add</a>
      </div>
    </div>
  </div>
</div>
<!-- End -->

<!-- Add Section Title Modal -->
<div class="modal fade" id="addSubTitleModal" tabindex="-1" aria-labelledby="addSubTitleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content px-4">
      <div class="modal-header border-bottom-0">
        <h5 class="modal-title" id="addSubTitleModalLabel">Add Section Title of the Project</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div>
          <label for="" class="form-label">Add Section Title</label>
          <textarea placeholder="Enter the section title of this project" rows="3" type="text" class="form-control" [(ngModel)]="titleValue"></textarea>
        </div>
      </div>
      <div class="modal-footer border-top-0">
        <a href="javascript:void(0)" class="text-decoration-none text-danger" data-bs-dismiss="modal"><i class="fa fa-close pe-2"></i> Close</a>
        <a href="javascript:void(0)" class="text-decoration-none ms-3" (click)="addSubTitle()"><i class="fa fa-plus pe-2"></i>Add</a>
      </div>
    </div>
  </div>
</div>
<!-- End -->

<!-- Add Link Modal -->
<div class="modal fade" id="addLinkModal" tabindex="-1" aria-labelledby="addLinkModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-lg">
    <div class="modal-content px-4">
      <div class="modal-header border-bottom-0">
        <h5 class="modal-title" id="addLinkModalLabel">Add Link</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <div class="row col-md-12 p-0 mx-0">
          <div class="col-md-12">
            <div class="col-md-6">
              <label for="">Alternative Text</label>
              <input type="text" class="form-control" placeholder="Enter alt text">
            </div>

            <div class="d-flex justify-content-start ms-0 mt-2">
              <div>
                <label for="" class="form-label">Enter image URL or browse your local computer.</label>
              </div>
              <div class="form-check">
                <input type="file" class="d-none" id="insert-image" accept=".jpg, .jpeg, .png" (change)="uploadImage($event)">
                <a href="javascript:void(0)" (click)="fireBrowser()">Browser Local</a>
              </div>
            </div>

            <div class="col-md-12">
              <input type="text" class="form-control" [(ngModel)]="anchorLink" placeholder="Enter your link">
            </div>
          </div>

          <div class="col-md-12 mt-3">
            <div class="position-relative">
              <div class="mb-2">
                Image Preview Container
              </div>
              <div class="pic-container">
                <img *ngIf="imageUrl != '' && imageUrl != null" [src]="imageUrl" width="100%" height="100%" alt="">
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-footer border-top-0">
        <a href="javascript:void(0)" class="text-decoration-none text-danger" data-bs-dismiss="modal"><i class="fa fa-close pe-2"></i> Close</a>
        <a href="javascript:void(0)" class="text-decoration-none ms-3" (click)="addImage()"><i class="fa fa-plus pe-2"></i>Add</a>
      </div>
    </div>
  </div>
</div>
<!-- End -->

<!-- Right click event popover -->

<div class="position-fixed c-po" id="popoverTemplate">
  <nav class ="navbar">
    <ul class ="nav navbar-nav">
      <li class="nav-item">
        <a href="javascript:void(0)" class="nav-link">
          Add numeric list
        </a>
      </li>
      <li class="nav-item">
        <a href="javascript:void(0)" class="nav-link">
          Add bulleted points
        </a>
      </li>
      <li class="nav-item">
        <a href="javascript:void(0)" class="nav-link">
          Insert paragraph above
        </a>
      </li>
      <li class="nav-item">
        <a href="javascript:void(0)" class="nav-link">
          Insert paragraph below
        </a>
      </li>
      <li class="nav-item">
        <a href="javascript:void(0)" (click)="closePopOver()" class="nav-link">
          Exit
        </a>
      </li>
    </ul>
  </nav>
</div>

<!-- End -->
