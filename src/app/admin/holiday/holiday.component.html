<div class="col-12 full-v main-container">
  <div class="col-12 row p-0 m-0">
    <div class="right-panel container col-md-12 p-0">
      <div class="col-md-12 row m-0 pe-4">
        <h4 class="p-0">Holiday (s)</h4>
      </div>

      <div class="x_panel mt-2">
        <div class="x_header">
          <div class="x_header_title d-flex justify-content-between align-items-center">
            <h2>Holidays<small>Details</small></h2>
            <div class="d-flex align-items-center">
              <a href="javascript:void(0)" class="text-decoration-none fw-bold pe-4" (click)="navToEmailLinkConfig()"><i
                class="fa fa-paper-plane pe-1"></i> Email Link Config
              </a>
              <button class="btn btn-primary-c" (click)="addHolidayPopup()"><i class="fa fa-plus-square pe-2"></i>Add Holiday</button>
            </div>
          </div>
        </div>

        <div class="px-1">
          <app-breadcrums></app-breadcrums>
        </div>
        <ng-container *ngIf="isPageReady">
          <div class="x_content mt-4">
            <div class="t-table t-list t-border col-md-12">
              <div class="hide-bar"></div>
              <div class="t-head">
                <div class="tr">
                  <div class="th fe-index">
                    <div class="t-index">
                      <a href="javascript:void()" class="ps-3">#</a>
                    </div>
                  </div>
                  <div class="th fe-2">
                    <div class="cell-wrapper">
                      <input class="form-control form-control-sm"
                        placeholder="Search by Name" (keydown.esc)="resetFilter()" oninput="this.value = this.value.toUpperCase()"
                        (keyup.enter)="filterRecords()" autofocus [(ngModel)]="holidayDetail.DescriptionNote">
                      <div class="t-filter" (click)="arrangeDetails(orderByDescriptionNoteAsc, 'DescriptionNote')">
                        <a href="javascript:void()" class="pe-2">Name</a>
                        <i class="fa fa-sort-amount-asc"
                          [ngClass]="{'d-none': orderByDescriptionNoteAsc == null || !orderByDescriptionNoteAsc }" aria-hidden="true"></i>
                        <i class="fa fa-sort-amount-desc"
                          [ngClass]="{'d-none': orderByDescriptionNoteAsc == null || orderByDescriptionNoteAsc }" aria-hidden="true"></i>
                      </div>
                    </div>
                  </div>
                  <div class="th fe-1">
                    <div class="cell-wrapper">
                      <input class="form-control form-control-sm" autofocus readonly
                        placeholder="Search by Name">
                      <div class="t-filter" (click)="arrangeDetails(orderByStartDateAsc, 'StartDate')">
                        <a href="javascript:void()" class="pe-2">Start Date</a>
                        <i class="fa fa-sort-amount-asc"
                          [ngClass]="{'d-none': orderByStartDateAsc == null || !orderByStartDateAsc }" aria-hidden="true"></i>
                        <i class="fa fa-sort-amount-desc"
                          [ngClass]="{'d-none': orderByStartDateAsc == null || orderByStartDateAsc }" aria-hidden="true"></i>
                      </div>
                    </div>
                  </div>
                  <div class="th fe-1">
                    <div class="cell-wrapper">
                      <input class="form-control form-control-sm" autofocus readonly
                        placeholder="Search by Name">
                        <div class="t-filter" (click)="arrangeDetails(orderByEndDateAsc, 'EndDate')">
                          <a href="javascript:void()" class="pe-2">End Date</a>
                          <i class="fa fa-sort-amount-asc"
                            [ngClass]="{'d-none': orderByEndDateAsc == null || !orderByEndDateAsc }" aria-hidden="true"></i>
                          <i class="fa fa-sort-amount-desc"
                            [ngClass]="{'d-none': orderByEndDateAsc == null || orderByEndDateAsc }" aria-hidden="true"></i>
                        </div>
                    </div>
                  </div>
                  <div class="th fe-1">
                    <div class="cell-wrapper">
                      <input class="form-control form-control-sm" autofocus
                        placeholder="Search by Total Days" readonly>
                      <div class="t-filter">
                        <a href="javascript:void()" class="pe-2">Total Days</a>
                      </div>
                    </div>
                  </div>
                  <div class="th fe-1">
                    <div class="cell-wrapper">
                      <select class="form-select" (change)="filterRecords()" [(ngModel)]="holidayDetail.IsHalfDay">
                        <option value="true">Half Day</option>
                        <option value="false">Full Day</option>
                      </select>
                      <div class="t-filter">
                        <a href="javascript:void()" class="pe-2">FullDay/HalfDay</a>
                      </div>
                    </div>
                  </div>
                  <div class="th fe-1">
                    <div class="cell-wrapper">
                      <input class="form-control form-control-sm" oninput="this.value = this.value.toUpperCase()"
                        placeholder="Search by Country Name" (keydown.esc)="resetFilter()"
                        (keyup.enter)="filterRecords()" autofocus [(ngModel)]="holidayDetail.Country">
                      <div class="t-filter" (click)="arrangeDetails(orderByCountryAsc, 'Country')">
                        <a href="javascript:void()" class="pe-2">Country</a>
                        <i class="fa fa-sort-amount-asc"
                          [ngClass]="{'d-none': orderByCountryAsc == null || !orderByCountryAsc }" aria-hidden="true"></i>
                        <i class="fa fa-sort-amount-desc"
                          [ngClass]="{'d-none': orderByCountryAsc == null || orderByCountryAsc }" aria-hidden="true"></i>
                      </div>
                    </div>
                  </div>
                  <div class="th fe-index text-center">ACTIONS</div>
                </div>
              </div>
              <div class="t-body">
                <ng-container *ngIf="allHolidayList.length > 0">
                  <div class="tr py-2" *ngFor="let holiday of allHolidayList; let i = index;">
                    <div class="td align-middle text-center fe-index">
                      <div class="cell-wrapper">
                        {{i+1}}
                      </div>
                    </div>
                    <div class="td align-middle fe-2">
                      <div class="cell-wrapper">
                        {{holiday.DescriptionNote}}
                      </div>
                    </div>
                    <div class="td align-middle fe-1">
                      <div class="cell-wrapper">
                        {{holiday.StartDate | date}}
                      </div>
                    </div>
                    <div class="td align-middle fe-1">
                      <div class="cell-wrapper">
                        {{holiday.EndDate | date}}
                      </div>
                    </div>
                    <div class="td align-middle fe-1">
                      <div class="cell-wrapper">
                        {{holiday.TotalDays | number: '1.2-2'}}
                      </div>
                    </div>
                    <div class="td align-middle fe-1">
                      <div class="cell-wrapper">
                        {{holiday.IsHalfDay ? 'HalfDay' : 'FullDay'}}
                      </div>
                    </div>
                     <div class="td align-middle fe-1">
                      <div class="cell-wrapper">
                        {{holiday.Country}}
                      </div>
                    </div>
                    <div class="td align-middle fe-index">
                      <div class="d-flex flex-row justify-content-evenly">
                        <a href="javascript:void(0)" (click)="editHoliday(holiday)">
                          <i class="fa fa-edit text-primary" aria-hidden="true"></i>
                        </a>
                        <a href="javascript:void(0)" (click)="deleteHolidayPopUp(holiday)">
                          <i class="fa fa-trash text-danger" aria-hidden="true"></i>
                        </a>
                      </div>
                    </div>
                  </div>
                </ng-container>
                <ng-container *ngIf="allHolidayList.length == 0">
                  <div class="custom-height fw-bold fs-3 py-5 my-5 text-danger d-flex align-items-center justify-content-center">
                    <p class="my-5 py-5">Record Not Found</p>
                  </div>
                </ng-container>
              </div>
            </div>
          </div>
          <div class="mt-3">
            <app-pagination [pagination]="holidayData" (onPageChange)="GetFilterResult($event)"></app-pagination>
          </div>
        </ng-container>
        <ng-container *ngIf="!isPageReady">
          <div class="fs-5 my-5 py-5 d-flex flex-column justify-content-center align-items-center">
            <div class="col-md-3 modal-container f-12 text-center cog-wheel">
              <img src="assets/images/cog.gif" alt="" />
              <h6 class="modal-title title-message">
                Please Wait ........
              </h6>
            </div>
          </div>
        </ng-container>
      </div>
    </div>
  </div>
</div>

<!-- Add/ Update Holiday List Modal -->
<div class="modal fade" id="manageHolidayModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="manageHolidayModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-centered">
    <div class="modal-content px-4">
      <div class="modal-header border-bottom-0">
        <h5 class="modal-title" id="manageHolidayModalLabel">{{selectedHoliday.CompanyCalendarId == 0 ? 'Add' : 'Update'}} Holiday</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <form [formGroup]="holidayForm">
          <div class="col-md-12 row">
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Company Name</label>
              <input type="text" placeholder="Company Name" readonly formControlName="CompanyName" class="form-control">
            </div>
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Event Name</label>
              <input type="text" placeholder="Event Name" oninput="this.value = this.value.toUpperCase()" onkeypress="return (event.charCode > 64 && event.charCode < 91) || (event.charCode > 96 && event.charCode < 123) || event.charCode == 32" formControlName="EventName" [ngClass]="{'error-field': submitted && f.EventName.errors !== null && f.EventName.errors.required}" class="form-control">
            </div>
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Is Holiday</label>
              <select class="form-select" formControlName="IsHoliday" [ngClass]="{'error-field': submitted && f.IsHoliday.errors !== null && f.IsHoliday.errors.required}">
                <option value="true">Yes</option>
                <option value="false">No</option>
              </select>
            </div>
          </div>
          <div class="col-md-12 row">
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Start Date</label>
              <form class="form-inline">
                <div class="form-group w-100">
                  <div class="input-group w-100" [ngClass]="{'error-field': submitted && f.StartDate.errors !== null && f.StartDate.errors.required}">
                    <input class="form-control" placeholder="yyyy-mm-dd" name="dp" [(ngModel)]="fromModel"
                      (dateSelect)="onfromDateSelection($event)" ngbDatepicker [minDate]="{year: 1970, month:1, day: 1}" [maxDate]="{year: 2050, month:1, day: 19}" #fd="ngbDatepicker">
                    <div class="input-group-append">
                      <button class="btn btn-outline-secondary calendar" (click)="fd.toggle()" type="button"><i
                          class="fa fa-calendar" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">End Date</label>
              <form class="form-inline">
                <div class="form-group w-100">
                  <div class="input-group w-100" [ngClass]="{'error-field': submitted && f.EndDate.errors !== null && f.EndDate.errors.required}">
                    <input class="form-control" placeholder="yyyy-mm-dd" name="dp" [(ngModel)]="toModel"
                      (dateSelect)="ontoDateSelection($event)" ngbDatepicker [minDate]="{year: 1970, month:1, day: 1}" [maxDate]="{year: 2050, month:1, day: 19}" #d="ngbDatepicker">
                    <div class="input-group-append">
                      <button class="btn btn-outline-secondary calendar" (click)="d.toggle()" type="button"><i
                          class="fa fa-calendar" aria-hidden="true"></i>
                      </button>
                    </div>
                  </div>
                </div>
              </form>
            </div>
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Is HalfDay</label>
              <select class="form-select" formControlName="IsHalfDay" [ngClass]="{'error-field': submitted && f.IsHalfDay.errors !== null && f.IsHalfDay.errors.required}">
                <option value="true">Yes</option>
                <option value="false">No</option>
              </select>
            </div>
          </div>
          <div class="col-md-12 row">
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Description Name</label>
              <input type="text" class="form-control" [ngClass]="{'error-field': submitted && f.DescriptionNote.errors !== null && f.DescriptionNote.errors.required}" oninput="this.value = this.value.toUpperCase()"  formControlName="DescriptionNote" placeholder="Description Note">
            </div>
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Applicable For</label>
              <select class="form-select" formControlName="ApplicableFor" [ngClass]="{'error-field': submitted && f.ApplicableFor.errors !== null && f.ApplicableFor.errors.required}">
                <option value="0">All</option>
              </select>
            </div>
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Country</label>
              <input type="text" oninput="this.value = this.value.toUpperCase()" [ngClass]="{'error-field': submitted && f.Country.errors !== null && f.Country.errors.required}" class="form-control" formControlName="Country" placeholder="Country">
            </div>
          </div>
          <div class="col-md-12 row">
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Year</label>
              <select class="form-select" formControlName="Year" [ngClass]="{'error-field': submitted && f.Year.errors !== null && f.Year.errors.required}">
                <option [value]="item" *ngFor="let item of years">{{item}}</option>
              </select>
            </div>
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Is Public Holiday</label>
              <select class="form-select" formControlName="IsPublicHoliday" [ngClass]="{'error-field': submitted && f.IsPublicHoliday.errors !== null && f.IsPublicHoliday.errors.required}">
                <option value="true">Yes</option>
                <option value="false">No</option>
              </select>
            </div>
            <div class="col-md-4 mt-3">
              <label for="" class="form-label">Is Company Custom Holiday</label>
              <select class="form-select" formControlName="IsCompanyCustomHoliday" [ngClass]="{'error-field': submitted && f.IsCompanyCustomHoliday.errors !== null && f.IsCompanyCustomHoliday.errors.required}">
                <option value="true">Yes</option>
                <option value="false">No</option>
              </select>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer border-top-0">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal"><i class="fa fa-close"></i> Close</button>
        <button class="btn btn-success" [disabled]="isLoading" (click)="manageHoliday()">
          <i class="fa" [ngClass]="{'fa-spin fa-spinner': isLoading, 'fa-plus': !isLoading}"></i>
          <span class="ps-2" *ngIf="selectedHoliday.CompanyCalendarId == 0">{{ isLoading ? 'Wait' : 'Add' }}</span>
          <span class="ps-2" *ngIf="selectedHoliday.CompanyCalendarId > 0">{{ isLoading ? 'Wait' : 'Update' }}</span>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Delete Holiday Modal -->
<div class="modal fade" id="deleteHolidayModal" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1" aria-labelledby="deleteHolidayModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered">
    <div class="modal-content px-4">
      <div class="modal-header border-bottom-0">
        <h5 class="modal-title" id="deleteHolidayModalLabel">Delete Holiday</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <table class="table">
          <thead>
            <tr>
              <th>Name</th>
              <th>Start Date</th>
              <th>End Date</th>
              <th>Total Days</th>
              <th>FullDay/HalfDay</th>
              <th>Country</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>{{selectedHoliday.DescriptionNote}}</td>
              <td>{{selectedHoliday.StartDate | date}}</td>
              <td>{{selectedHoliday.EndDate | date}}</td>
              <td>{{selectedHoliday.TotalDays}}</td>
              <td>{{selectedHoliday.IsHalfDay ? 'HalfDay' : 'FullDay'}}</td>
              <td>{{selectedHoliday.Country}}</td>
            </tr>
          </tbody>
        </table>
        <p class="text-danger fw-bold mb-0">* Note: If you delete then it will be permanently deleted.</p>
      </div>
      <div class="modal-footer border-top-0">
        <button type="button" class="btn btn-danger" data-bs-dismiss="modal"><i class="fa fa-close"></i> Close</button>
        <button class="btn btn-success" [disabled]="isLoading" (click)="deleteHoliday()">
          <i class="fa" [ngClass]="{'fa-spin fa-spinner': isLoading, 'fa-plus': !isLoading}"></i>
          <span class="ps-2">{{ isLoading ? 'Wait' : 'Delete' }}</span>
        </button>
      </div>
    </div>
  </div>
</div>
