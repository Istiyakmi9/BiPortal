<div class="col-md-12 main-container">
  <ng-container *ngIf="isEmpPageReady">
    <div class="x_panel">
        <div class="x_header">
            <div class="x_header_title mt-3">
              <div class="row title-header">
                <div class="col-md-6 d-flex align-items-center" *ngIf="fileLoaded">
                  <label class="form-label pe-3 mt-1">Developer Name *</label>
                  <div style="width: 20rem">
                    <app-iautocomplete [data]="autoCompleteModal" [(ngModel)]="employeeId"></app-iautocomplete>
                  </div>
                </div>
                <div class="col-md-6 filter-action-container text-end">
                  <a href="javascript:void(0)" class="text-dark" (click)="toggleFilter()">
                    <i class="fa fa-filter zoom-2"></i>
                  </a>
                  <a href="javascript:void(0)" (click)="resetFilter()" class="me-3">
                    <i class="fa fa-refresh zoom-2" aria-hidden="true"></i>
                  </a>
                </div>
              </div>
              <div class="mt-3 row" *ngIf="filterbox">
                <hr>
                <div class="col-md-7 row ms-1 p-0">
                  <div class="col-md-4 d-flex justify-content-center align-items-center">
                    <label for="" class="pe-2">From</label>
                    <form class="form-inline">
                      <div class="form-group">
                        <div class="input-group">
                          <input class="form-control" placeholder="yyyy-mm-dd"
                          (dateSelect)="fromDateSelection($event)" name="from" [(ngModel)]="fromModel" ngbDatepicker #from="ngbDatepicker">
                          <div class="input-group-append">
                            <button class="btn btn-outline-dark fa fa-calendar btn-design" (click)="from.toggle()" type="button"></button>
                          </div>
                        </div>
                      </div>
                    </form>

                    <!-- <input class="form-control table-filter-control" (keyup.enter)="filterRecords()" [(ngModel)]="employeeFile.GeneratedOn" placeholder="From Date"> -->
                  </div>
                  <div class="col-md-4 d-flex justify-content-center align-items-center">
                    <label for="" class="pe-2">To</label>
                    <form class="form-inline">
                      <div class="form-group">
                        <div class="input-group">
                          <input class="form-control" placeholder="yyyy-mm-dd"
                          (dateSelect)="toDateSelection($event)" name="to" [(ngModel)]="toModel" ngbDatepicker #to="ngbDatepicker">
                          <div class="input-group-append">
                            <button class="btn btn-outline-dark fa fa-calendar btn-design" (click)="to.toggle()" type="button"></button>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                </div>
                <div class="col-md-5 ms-2 text-end">
                  <label class="pe-2">Check to apply filter for all</label>
                  <input type="checkbox" (change)="alterResultSet($event)" id="checkall">

                </div>
              </div>

              <!-- <div class="float-end d-inline create-link">
                <div class="btn-group me-4" role="group" aria-label="Basic radio toggle button group">
                  <input type="radio" class="btn-check" name="btnradio" id="btnradio1" autocomplete="off"
                      checked>
                  <label class="btn btn-outline-primary" for="btnradio1">Active</label>

                  <input type="radio" class="btn-check" name="btnradio" id="btnradio2" autocomplete="off">
                  <label class="btn btn-outline-dark" for="btnradio2">InActive</label>

                  <input type="radio" class="btn-check" name="btnradio" id="btnradio3" autocomplete="off">
                  <label class="btn btn-outline-success" for="btnradio3">All</label>
                </div>
              </div> -->
            </div>
        </div>

        <!-- Pdf viewer modal -->
        <div class="d-none file-container" id="file-container" (click)="closePdfViewer()">
            <div class="text-end">
                <a (click)="closePdfViewer()" class="close_view">
                    <i class="fa fa-times fa-2x" aria-hidden="true"></i>
                </a>
            </div>
            <iframe src="" width="800px" height="600px" style="border: none;"></iframe>
        </div>

        <div class="x_content">
            <!-- <app-dynamic-table [config]="tableConfiguration" (clicked)="ClickEvents($event)"></app-dynamic-table> -->
            <!-- <div>Use below input fields textbox to customize column name</div> -->
            <table class="table table-striped table-hover">
              <thead>
                <tr>
                  <th>
                    #
                  </th>
                  <th>
                    <input class="form-control table-filter-control form-control-sm" (keyup.enter)="filterRecords()" [(ngModel)]="employeeFile.ClientName" placeholder="By Client Name">
                    <div class="col-title">
                        Client Name
                    </div>
                  </th>
                  <th width="6%">
                    <input class="form-control table-filter-control form-control-sm" (keyup.enter)="filterRecords()" [(ngModel)]="employeeFile.BillNo" placeholder="By Bill No">
                    <div class="col-title">
                        Bill No.#
                    </div>
                  </th>
                  <!-- <th>Month</th> -->
                  <th width="8%">
                    <select class="form-control table-filter-control form-control-sm" (keyup.enter)="filterRecords()" [(ngModel)]="employeeFile.Status">
                      <option value="0">Status</option>
                      <option value="1">Completed</option>
                      <option value="2">Pending</option>
                      <option value="3">Canceled</option>
                    </select>
                    <div class="col-title">
                        Status
                    </div>
                  </th>
                  <th width="8%">
                    <div class="col-title">
                        Paid On
                    </div>
                  </th>
                  <th width="8%">
                    <input class="form-control table-filter-control form-control-sm" (keyup.enter)="filterRecords()" [(ngModel)]="employeeFile.Month" placeholder="Month">
                    <div class="col-title">
                        Month
                    </div>
                  </th>
                  <th width="14%">
                    <input class="form-control table-filter-control form-control-sm" (keyup.enter)="filterRecords()" [(ngModel)]="employeeFile.BilledAmount" placeholder="By Billed Amount">
                    <div class="col-title">
                        Billed Amount
                    </div>
                  </th>
                  <th width="12%">
                    <input class="form-control table-filter-control form-control-sm" (keyup.enter)="filterRecords()" [(ngModel)]="employeeFile.ReceivedAmount" placeholder="By Received Amount">
                    <div class="col-title">
                        Received
                        <small class="text-muted">[- 10% TDS]</small>
                    </div>
                  </th>
                  <th width="7%">
                    <select class="form-control table-filter-control form-control-sm" (keyup.enter)="filterRecords()" [(ngModel)]="employeeFile.GSTStatus">
                      <option value="0">Status</option>
                      <option value="1">Completed</option>
                      <option value="2">Pending</option>
                      <option value="3">Canceled</option>
                      <option value="6">Raised</option>
                    </select>
                    <div class="col-title" >
                        GST
                    </div>
                  </th>
                  <th class="text-center">
                    <button class="btn btn-outline-dark btn-sm" (click)="filterRecords()">
                      <i class="fa fa-search"></i>
                    </button>

                    <div class="col-title text-center">
                     Action
                    </div>
                  </th>
                </tr>
              </thead>
              <tbody>
                <tr *ngFor="let user of billDetails">
                  <td>{{user.FileUid}}</td>
                  <td>{{user.ClientName}}</td>
                  <td>
                    <a href="javascript:void(0)" (click)="EditCurrentDocument(user)">{{user.BillNo}}</a>
                  </td>
                  <!-- <td>{{user.Month}}</td> -->
                  <td>{{user.Status}}</td>
                  <td>{{user.PaidOn}}</td>
                  <td>{{user.Month}}</td>
                  <td>
                    <div>
                      {{user.BilledAmount | number : '1.2-2'}}
                      <div>
                        <small class="s-item text-muted me-2">[A] {{user.SalaryAmount | number : '1.2-2'}}</small>
                        <small class="s-item text-muted">[G] {{user.GSTAmount | number : '1.2-2'}}</small>
                      </div>
                    </div>
                  </td>
                  <td>{{user.ReceivedAmount | number : '1.2-2'}}</td>
                  <td>
                    <a href="javascript:void(0)" class="h-font" (click)="updateGSTStatus(user.BillNo, user.GSTAmount)">
                      {{user.GSTStatus}}
                    </a>
                  </td>
                  <td>
                    <div class="d-flex flex-row justify-content-around">
                      <a href="javascript:void(0)">
                        <span class="badge bg-primary ms-1 me-1"><i class="fa fa-cogs" aria-hidden="true" (click)="UpdateCurrent(user.FileUid)"></i></span>
                      </a>
                      <a href="javascript:void(0)" (click)="AddEditDocuments(employee.Mobile)">
                        <span class="badge bg-dark">
                            <i class="fa fa-folder" aria-hidden="true"></i>
                        </span>
                      </a>
                      <a href="javascript:void(0)">
                        <span class="badge bg-success ms-1 me-1"><i class="fa fa-file-pdf-o" aria-hidden="true" (click)="viewPdfFile(user)"></i></span>
                      </a>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
        </div>
        <div class="mt-3">
          <app-pagination [pagination]="singleEmployee" (onPageChange)="GetFilterResult($event)"></app-pagination>
        </div>
    </div>
  </ng-container>
</div>


<!-- add update detail modal -->
<div class="modal fade" id="gstupdateModal" tabindex="-1">
  <div class="modal-dialog modal-lg">
      <div class="modal-content">
          <div class="modal-header">
              <h5 class="modal-title">Add Or Update</h5>
              <button type="button" class="close" (click)="closeWindow()" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
              </button>
          </div>
          <div class="modal-body f-12">
              <div class="col-md-12">
                  <div [formGroup]="gstDetailForm" class="col-md-12 popup-form">
                      <div class="col-md-12 row m-0">
                        <div class="col-4 form-group">
                          <label for="">Bill No.#</label>
                          <input class="form-control disabled text-muted" disabled formControlName="Billno">
                        </div>
                          <div class="col-4 form-group">
                              <label for="">GST Status</label>
                              <select formControlName="Gststatus" name="Gststatus" class="form-control">
                                  <option value="0">Status Type</option>
                                  <option value="1">Completed</option>
                                  <option value="2">Pending</option>
                                  <option value="3">Canceled</option>
                                  <option value="4">Not Generated</option>
                                  <option value="5">Rejected</option>
                                  <option value="6">Generated</option>
                              </select>
                          </div>
                          <div class="col-4 form-group">
                              <label for="">Paid On</label>
                              <form class="form-inline">
                                  <div class="form-group w-100">
                                      <div class="input-group w-100">
                                          <input class="form-control" placeholder="yyyy-mm-dd" name="dp"
                                              [(ngModel)]="model" (dateSelect)="onDateSelection($event)"
                                              ngbDatepicker #d="ngbDatepicker">
                                          <div class="input-group-append">
                                              <button class="btn btn-outline-secondary calendar"
                                                  (click)="d.toggle()" type="button"><i class="fa fa-calendar"
                                                      aria-hidden="true"></i>
                                              </button>
                                          </div>
                                      </div>
                                  </div>
                              </form>
                          </div>
                      </div>
                      <div class="col-md-12 row m-0 mt-4">
                        <div class="col-4 form-group">
                          <label for="">GST Amount</label>
                          <input class="form-control disabled text-muted" disabled placeholder="GST Amount" formControlName="Amount">
                        </div>
                        <div class="col-4 form-group">
                            <label for="">Paid By</label>
                            <select formControlName="Paidby" name="Paidby" class="form-control">
                                <option value="0">Employee Name</option>
                                <option value="1">Completed</option>
                                <option value="2">Pending</option>
                                <option value="3">Canceled</option>
                                <option value="4">Not Generated</option>
                                <option value="5">Rejected</option>
                            </select>
                        </div>
                      </div>
                      <div class="col-md-12 row m-0">
                          <div class="form-group mt-4">
                              <input type="file" id="uploadocument" class="d-none" multiple (change)="GetDocumentFile($event)"/>
                              <a href="javascript:void(0)" class="text-muted d-inline-block mt-4 mb-2">
                                <i class="fa fa-upload zoom-2"></i>
                              </a>
                              <div class="file-upload-zone x_panel"></div>
                          </div>
                      </div>
                  </div>
              </div>
          </div>
          <div class="modal-footer">
              <button type="button" class="btn btn-secondary" (click)="closeWindow()">Close</button>

              <button class="btn btn-primary" [disabled]="isLoading" (click)="submitGSTStatusDetail()">
                  <i class="fa" [ngClass]="{'fa-spin fa-spinner': isLoading, 'fa-check': !isLoading}"></i>
                  {{ isLoading ? 'Processing' : 'Submit' }}
              </button>
          </div>
      </div>
  </div>
</div>


<!-- add update detail modal -->
<div class="modal fade" id="addupdateModal" tabindex="-1">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title">GST Status Update Modal</h5>
                <button type="button" class="close" (click)="closeWindow()" aria-label="Close">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body f-12">
                <div class="col-md-12">
                    <div [formGroup]="documentForm" class="col-md-12 popup-form">
                        <div class="col-md-12 row m-0">
                            <div class="col-6 form-group">
                                <label for="">File Status</label>
                                <select formControlName="StatusId" name="StatusId" class="form-control">
                                  <option value="0">File Status Type</option>
                                  <option value="1">Completed</option>
                                  <option value="2">Pending</option>
                                  <option value="3">Canceled</option>
                                  <option value="4">Not Generated</option>
                                  <option value="5">Rejected</option>
                                  <option value="7">Bill Raised</option>
                              </select>
                            </div>
                            <div class="col-6 form-group">
                                <label for="">Updated On</label>
                                <form class="form-inline">
                                    <div class="form-group w-100">
                                        <div class="input-group w-100">
                                            <input class="form-control" placeholder="yyyy-mm-dd" name="dp"
                                                [(ngModel)]="model" (dateSelect)="onDateSelection($event)"
                                                ngbDatepicker #billd="ngbDatepicker">
                                            <div class="input-group-append">
                                                <button class="btn btn-outline-secondary calendar"
                                                    (click)="billd.toggle()" type="button"><i class="fa fa-calendar"
                                                        aria-hidden="true"></i>
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </form>
                            </div>
                        </div>
                        <div class="col-md-12 row m-0">
                            <div class="form-group mt-4">
                                <label for="">Notes</label>
                                <textarea name="Notes" rows="3" formControlName="Notes"
                                    class="form-control"></textarea>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" (click)="closeWindow()">Close</button>

                <button class="btn btn-primary" [disabled]="isLoading" (click)="updateRecord()">
                    <i class="fa" [ngClass]="{'fa-spin fa-spinner': isLoading, 'fa-check': !isLoading}"></i>
                    {{ isLoading ? 'Processing' : 'Submit' }}
                </button>
            </div>
        </div>
    </div>
</div>
